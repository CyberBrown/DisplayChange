<!DOCTYPE html>
<html>
<head>
    <title>Display</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* Basic styles for the application body */
        body {
            font-family: Arial, sans-serif;
            background-color: #f7fafc;
            margin: 0;
            padding: 0;
            overflow: hidden; /* Hide scrollbars */
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }
        /* Style for the main container to be more visually appealing */
        .container {
            background-color: #fff;
            border-radius: 1.875rem;
            box-shadow: 0 25px 37.5px -7.5px rgba(0, 0, 0, 0.1), 0 10px 15px -5px rgba(0, 0, 0, 0.05);
            padding: 5rem;
            width: 100%;
            max-width: 70rem;
            margin: auto;
            border: 1px solid #ccc;
        }
        /* Style for buttons to be more visually appealing */
        .button {
            width: 100%;
            color: white;
            font-weight: bold;
            padding: 2.5rem 3.75rem;
            margin-bottom: 2.5rem;
            border-radius: 1.25rem;
            font-size: 2.8125rem;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .button.local {
            background-color: #4299e1;
        }
        .button.streaming {
            background-color: #667eea;
        }
        .close-button {
            color: #718096;
            font-weight: 500;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.25rem;
        }
    </style>
    <script type="text/javascript">
        // HTA (HTML Application) for changing display and resolution
        
        // This script block must be run before the body loads.
        try {
            // Center the window on the screen (scaled up by 2.5x)
            window.resizeTo(1250, 1000);
            window.moveTo(
                (screen.width - 1250) / 2,
                (screen.height - 1000) / 2
            );
        } catch (e) {
            // This will fail in a normal browser, which is fine.
            console.error("HTA window resizing failed. Are you running this as a .hta file?");
        }
    </script>
    <script type="text/javascript">
        /**
         * Executes the command to change display to primary, disable the secondary display and set resolution to 5120x1440.
         * This function works only when the file is run as an HTA (HTML Application).
         */
        function setLocalDisplay() {
            try {
                // Create a Shell object to run external commands. This is HTA-specific.
                var shell = new ActiveXObject("WScript.Shell");

                // PowerShell command to enable DisplayId 1, disable DisplayId 2, and set a specific resolution.
                var command = "powershell.exe -NoProfile -ExecutionPolicy Bypass -Command \"Enable-Display -DisplayId 1; Disable-Display -DisplayID 2; Set-DisplayResolution -width 5120 -height 1440\"";
                
                // Run the command. The '0' means hide the command window, 'true' means wait for it to complete.
                shell.Run(command, 0, true);
                
                // Optional: Close the app after changing the resolution
                // window.close();

            } catch (e) {
                // This error will appear if you run this file in a normal web browser.
                alert("Error: This application must be run as a .hta file to function.\n\nCould not create ActiveXObject.");
                console.error("ActiveXObject could not be created.", e);
            }
        }
    </script>
    <script type="text/javascript">
        /**
         * Executes the command to change display to secondary, disable the primary display and set resolution to 2560x1600.
         * This function works only when the file is run as an HTA (HTML Application).
         */
        function setStreamingDisplay() {
            try {
                // Create a Shell object to run external commands. This is HTA-specific.
                var shell = new ActiveXObject("WScript.Shell");
                
                // PowerShell command to enable DisplayId 2, disable DisplayId 1, and set a specific resolution.
                var command = "powershell.exe -NoProfile -ExecutionPolicy Bypass -Command \"Enable-Display -DisplayId 2; Disable-Display -DisplayID 1; Set-DisplayResolution -width 2560 -height 1600\"";
                
                // Run the command. The '0' means hide the command window, 'true' means wait for it to complete.
                shell.Run(command, 0, true);
                
                // Optional: Close the app after changing the resolution
                // window.close();

            } catch (e) {
                // This error will appear if you run this file in a normal web browser.
                alert("Error: This application must be run as a .hta file to function.\n\nCould not create ActiveXObject.");
                console.error("ActiveXObject could not be created.", e);
            }
        }
    </script>
</head>
<body>
    <!-- Main Popup Window Container -->
    <div class="container">
        
        <!-- Header -->
        <div style="text-align: center; margin-bottom: 5rem;">
            <h1 style="font-size: 3.75rem; font-weight: bold; color: #2d3748;">Choose a Monitor Configuration</h1>
            <p style="color: #718096; margin-top: 0.625rem; font-size: 1.25rem;">Select streaming or local display</p>
        </div>

        <!-- Shortcut Buttons Container -->
        <div>
            <!-- Shortcut Button 1: Local -->
            <button
                onclick="setLocalDisplay()"
                class="button local">
                Local
            </button>

            <!-- Shortcut Button 2: Streaming -->
            <button
                onclick="setStreamingDisplay()"
                class="button streaming">
                Streaming
            </button>
        </div>

        <!-- Close Button -->
        <div style="margin-top: 5rem; text-align: center;">
             <button
                onclick="window.close();"
                class="close-button">Close</button>
        </div>
    </div>
</body>
</html>